<!DOCTYPE html>
    <html>
    <head>
        <meta charset="UTF-8">
        <title>&#x7B2C;&#x4E94;&#x7AE0; &#x540C;&#x6B65;&#x65F6;&#x5E8F;&#x7535;&#x8DEF;&#x8BBE;&#x8BA1;</title>
        <style>
</style>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" integrity="sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j" crossorigin="anonymous">
<link href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
<style>
            body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', system-ui, 'Ubuntu', 'Droid Sans', sans-serif;
                font-size: 14px;
                line-height: 1.6;
            }
        </style>
        <style>
.task-list-item { list-style-type: none; } .task-list-item-checkbox { margin-left: -20px; vertical-align: middle; }
</style>
        
        <script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script>
        
    </head>
    <body class="vscode-body vscode-light">
        <h1 id="第五章-同步时序电路设计">第五章 同步时序电路设计</h1>
<p>考点：会画ASM图，能画出对应波形图，能写出代码</p>
<h2 id="51-sequential-logic-circuit">5.1 Sequential Logic Circuit</h2>
<h3 id="three-significant-time-parameters-p87"><strong>Three significant time parameters</strong> (P87)</h3>
<ul>
<li>建立时间<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mrow><mi>s</mi><mi>u</mi></mrow></msub></mrow><annotation encoding="application/x-tex">t_{su}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76508em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">u</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>：触发器的时钟信号上升沿到来前数据稳定不变的时间</li>
<li>保持时间<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mrow><mi>h</mi><mi>o</mi><mi>l</mi><mi>d</mi></mrow></msub></mrow><annotation encoding="application/x-tex">t_{hold}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76508em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>$：触发器时钟信号上升沿到来后数据稳定不变的时间</li>
<li>传播延时<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mrow><mi>c</mi><mo>−</mo><mi>q</mi></mrow></msub></mrow><annotation encoding="application/x-tex">t_{c-q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9011879999999999em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.25833100000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">c</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">q</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>：信号在传播路径上的延时</li>
<li>最小传播时间必须满足：</li>
</ul>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo>&gt;</mo><msub><mi>e</mi><mrow><mi>c</mi><mo>−</mo><mi>q</mi></mrow></msub><mo>+</mo><msub><mi>t</mi><mrow><mi>h</mi><mi>o</mi><mi>l</mi><mi>d</mi></mrow></msub><mo>+</mo><msub><mi>t</mi><mrow><mi>s</mi><mi>u</mi></mrow></msub></mrow><annotation encoding="application/x-tex">T&gt;e_{c-q}+t_{hold}+t_{su}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8694379999999999em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.25833100000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">c</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">q</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.76508em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.76508em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">u</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<h2 id="52-state-machine">5.2 State Machine</h2>
<ul>
<li>A mathematic model for computer programs or sequential logic description.</li>
<li>A sequential logic event can be considered as an abstract machine with a finite number of states. The machine is in one state only at a given time.</li>
<li>Change from one state to another can be initiated by a triggering event or condition (state transition)s</li>
</ul>
<h3 id="521-race-and-hazard">5.2.1 Race and Hazard</h3>
<ul>
<li>Race and Hazard: a type of flaw in electronic system. A device may received signals with different delay due to different paths which may causes transient error in output.</li>
<li>In sequential logic，the next state and output are determined by combinational logic,  where race and hazard may occur. Mistakes may be introduced in the whole sequential system.</li>
<li>Race and Hazard can be avoided by synchronous sequential logic.</li>
</ul>
<h3 id="522-asmalgorithmic-state-machine-chart">5.2.2 ASM(Algorithmic State Machine) Chart</h3>
<ul>
<li>It resembles software flow chart, but it has corresponding hardware structure.</li>
</ul>
<p><strong>Components</strong>(P90-91)</p>
<img src="file:///c:\Users\Zening Lin\OneDrive\SCUT\Professional Courses\Digital System Design\Notes for Digital System Design\markdown\pictures\5-3-1-ASM-Chart-1.png">
<h4 id="5221-state-box">5.2.2.1 State box</h4>
<ul>
<li>状态名称左上角，编码右上角，框内写操作内容</li>
<li>编码方式
<ul>
<li>二进制编码：需要最少数目寄存器</li>
<li>格雷码：速度较慢，每次只会变一位</li>
<li>one-hot编码：较长，需要最多寄存器，逻辑简单，速度快</li>
</ul>
</li>
<li>区分操作与输出
<ul>
<li>操作：例如<code>R&lt;-0</code>表示赋值，直到下一次重新赋值才改变<code>R</code>的值</li>
<li>输出：例如<code>C='1'</code>，表示只在这个状态中才有<code>c='1'</code>其他状态<code>c='0'</code></li>
</ul>
</li>
<li>一个时钟周期内完成状态
<img src="file:///c:\Users\Zening Lin\OneDrive\SCUT\Professional Courses\Digital System Design\Notes for Digital System Design\markdown\pictures\5-3-1-ASM-Chart-2.png"></li>
</ul>
<h4 id="5222-decision-box">5.2.2.2 Decision Box</h4>
<ul>
<li>The decision box must <strong>follow and be associated with a state box</strong>. The decision is made in the <strong>same clock cycle</strong> as the actions of the associated state.</li>
</ul>
<h4 id="5223-conditional-output-box">5.2.2.3 Conditional Output Box</h4>
<ul>
<li><strong>It should follow a decision box</strong>. The output signal is asserted in the same clock cycle as those in the associated decision box.</li>
</ul>
<h4 id="5224-summary">5.2.2.4 Summary</h4>
<ul>
<li><strong><code>区分state box</code>和<code>conditional output box</code></strong>
<ul>
<li>(P91 图5-12) <code>Decision Box</code>与其上面的<code>State Box</code>在同一时钟周期内完成，若<code>Decison Box</code>下接<code>Conditional Output Box</code>，则该<code>Conditional Output Box</code>与上面的<code>Decison Box</code>和<code>State Box</code>在同一个时钟周期内完成操作</li>
</ul>
</li>
<li>状态机有同步和非同步两种方式，按照常规方式为非同步（输出信号的时序不固定）；若使用临时量存储输出值，最后的输出操作放到seq中，则输出信号按照时钟时序输出，这种方式为同步。</li>
</ul>
<h4 id="5225-state-and-state-box">5.2.2.5 <strong>State and State Box</strong></h4>
<ul>
<li>One state  is more than a state box.</li>
<li>Conditional output box, or decision box can also be a part of the state.</li>
<li>Each state represents a system state during one clock cycle, indicating the operations to be done in the  state.
r4</li>
</ul>
<h3 id="523-classification-of-fsm"><strong>5.2.3 Classification of FSM</strong></h3>
<h4 id="in-terms-of-signal-outputting">In terms of Signal Outputting</h4>
<ul>
<li><strong>Mealy</strong>: the output depends on both memory state and the input</li>
<li><strong>Moore</strong>: The output depends on memory state only</li>
</ul>
<p>Differences:</p>
<ul>
<li>Moore machine needs more states than Mealy machine.</li>
<li>The output of Moore machine is independent of current input, <strong>the effect brought by current input will take palce in the next clock cycle</strong></li>
<li>The output of Mealy machine depends on both current state and input. <strong>Input variation leads to immediate output change.</strong> The output can change during the current state.</li>
<li>Moore 输出端自动同步，mealy需要人为加入同步信号</li>
</ul>
<p>判断方法：</p>
<ol>
<li>看ASM图，每一个状态框中是否要用到输入</li>
<li>看RTL图，看输出是否依赖输入</li>
</ol>
<h4 id="in-terms-of-structure">In terms of structure</h4>
<ul>
<li>One Process: Needs more res <strong>复习2P89</strong>
<ul>
<li>可能会引入很多额外的寄存器</li>
<li><strong>将state定义为variable</strong></li>
</ul>
</li>
<li>Two Process: Needs less res, recommended
<ul>
<li>最常见的seq和com两个进程，一个用于状态寄存器，一个用于控制次态逻辑和输出</li>
<li><strong>常考</strong>，务必记住格式</li>
<li>state应为signal 因为要在进程之间传递</li>
</ul>
</li>
<li>Three Process
<ul>
<li>三个进程，一个状态寄存器，一个次态逻辑，一个当前状态输出（把Two Process的com进程进一步拆分，次态逻辑部分和状态内操作分开）</li>
</ul>
</li>
</ul>
<h3 id="状态编码方式考察编码方式和选择">状态编码方式（考察编码方式和选择）</h3>
<p>在综合的时候对Type枚举类型会进行编码，<strong>编码方式可以人为指定（复习2P109）课本p103格式</strong></p>
<ul>
<li>CPLD更多的提供组合逻辑，而FPGA更多的提供触发器资源，所以CPLD多使用gray-code，而FPGA多使用one-hot编码。</li>
<li>对于小型设计使用gray-code和binary编码更有效，而大型状态机使用one-hot编码更有效。</li>
</ul>
<ol>
<li>二进制编码</li>
</ol>
<ul>
<li>需要寄存器数量最少</li>
<li>需要更多外部辅助逻辑且速度较慢</li>
</ul>
<ol start="2">
<li>格雷码</li>
</ol>
<ul>
<li>触发器少</li>
<li>速度慢</li>
<li>不会产生两位同时反转的情况避免竞争冒险，异步使用的时候较为有利</li>
</ul>
<ol start="3">
<li>one-hot编码</li>
</ol>
<ul>
<li>寄存器数目最多</li>
<li>逻辑简单速度快</li>
</ul>
<hr>

    </body>
    </html>